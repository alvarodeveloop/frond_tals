{"version":3,"sources":["webpack:///./src/app/enterprise/interaction/interaction.component.css","webpack:///./src/app/enterprise/interaction/interaction.component.html","webpack:///./src/app/enterprise/interaction/interaction.component.ts","webpack:///./src/app/enterprise/interaction/interaction.module.ts","webpack:///./src/app/enterprise/interaction/interaction.routes.ts"],"names":[],"mappings":"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","file":"enterprise-interaction-interaction-module.js","sourcesContent":["module.exports = \".div_chat{\\r\\n  border: 1px solid lightgray;\\r\\n  height: 300px;\\r\\n  max-height: 300px; \\r\\n  overflow-y: scroll;\\r\\n}\\r\\n\\r\\n.sordo{\\r\\n  width: 50%;\\r\\n  color: white;\\r\\n  text-align: center;\\r\\n}\\r\\n\\r\\n.empresa{\\r\\n  margin-left: 50%;\\r\\n  color: white;\\r\\n  width: 50%;\\r\\n  text-align: center; \\r\\n}\"","module.exports = \"<div class=\\\"pd-20 bg-white border-radius-4 box-shadow mb-30 animated slideInUp\\\">\\r\\n  <div class=\\\"pre-loader\\\" *ngIf=\\\"loading\\\">Cargando Respuesta</div>\\r\\n  <div class=\\\"row\\\">\\r\\n    <div class=\\\"col-md-12 col-sm-12\\\">\\r\\n      <h2 class=\\\"text-center\\\">Interacci贸n Tals</h2>\\r\\n      <p class=\\\"text-center\\\">{{ estadoConexionCliente }}</p>\\r\\n      <div class=\\\"row\\\">\\r\\n        <div class=\\\"col-md-6 col-sm-6\\\">\\r\\n          <div class=\\\"row no-gutters\\\">\\r\\n            <div class=\\\"col-md-11 col-sm-11 offset-sm-1 offset-md-1\\\">\\r\\n              <textarea name=\\\"entradaTexto\\\" id=\\\"entradaTexto\\\" rows=\\\"4\\\" class=\\\"form-control\\\"></textarea>\\r\\n              <br/>\\r\\n            </div>\\r\\n          </div>\\r\\n          <div class=\\\"row no-gutters\\\">\\r\\n            <div class=\\\"col-md-5 col-sm-5 offset-md-1 offset-sm-1\\\">\\r\\n              <button class=\\\"btn btn-danger btn-block recog\\\" (click)=\\\"initSpeakers()\\\">Reconocer Voz&nbsp;<i class=\\\"fa fa-comment\\\"></i></button>\\r\\n            </div>\\r\\n            <div class=\\\"col-md-5 col-sm-5 offset-md-1 offset-sm-1\\\">\\r\\n              <button class=\\\"btn btn-primary btn-block\\\" (click)=\\\"sendMessage()\\\">Enviar&nbsp;<i class=\\\"fa fa-send\\\"></i></button>\\r\\n            </div>\\r\\n          </div>\\r\\n        </div>\\r\\n        <div class=\\\"col-md-6 col-sm-6\\\">\\r\\n          <div class=\\\"row no-gutters\\\">\\r\\n            <div class=\\\"col-md-6 col-sm-6 text-center\\\">\\r\\n              <h4 class=\\\"text-center\\\">Texto</h4>\\r\\n              <div id=\\\"tag_animacion\\\"></div>\\r\\n            </div>\\r\\n            <div class=\\\"col-md-6 col-sm-6 text-center\\\">\\r\\n              <h4 class=\\\"text-center\\\">Audio</h4>\\r\\n              <div id=\\\"tag_audio\\\">\\r\\n              </div>\\r\\n            </div>\\r\\n          </div>\\r\\n          <div class=\\\"clearfix\\\"></div>\\r\\n        </div>\\r\\n      </div>\\r\\n      <div class=\\\"clearfix\\\"></div>\\r\\n      <br>\\r\\n      <div class=\\\"row no-gutters\\\">\\r\\n        <div class=\\\"col-md-5 col-sm-5\\\">\\r\\n          <div class=\\\"text-center\\\">\\r\\n            <b>Instrucciones: </b> \\r\\n            <ul class=\\\"list-group text-center\\\">\\r\\n              <li class=\\\"list-group-item\\\">Debe escribir un texto o usar el microfono para comunicarse con el usuario en linea</li>\\r\\n              <li class=\\\"list-group-item\\\">Del lado derecho de la pantalla saldra la respuesta del cliente y podrar ver el historial de mensajes con el usuario</li>\\r\\n            </ul>\\r\\n          </div>\\r\\n        </div>\\r\\n        <div class=\\\"col-md-6 col-sm-6 offset-md-1 offset-sm-1\\\">\\r\\n          <h4 class=\\\"text-center\\\">Historial de Mensajes</h4>\\r\\n          <div class=\\\"text-center div_chat\\\">\\r\\n            <div [ngClass]=\\\"item.tipo == 1 ? 'alert alert-info empresa' : 'alert alert-danger sordo'\\\" *ngFor=\\\"let item of historial; let index = index\\\">\\r\\n              {{ item.mensaje }}\\r\\n            </div>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n          \\r\\n    </div>\\r\\n  </div>\\r\\n</div>\"","import { Component, OnInit,ElementRef, OnDestroy } from '@angular/core';\r\nimport { AnimationsService } from '../../service/animations.service'\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { InteractionService } from '../../service/interaction.service'\r\nimport { environment } from '../../../environments/environment'\r\nimport { forkJoin } from 'rxjs'\r\n\r\ndeclare var $ : any\r\n\r\n@Component({\r\n  selector: 'app-interaction',\r\n  templateUrl: './interaction.component.html',\r\n  styleUrls: ['./interaction.component.css']\r\n})\r\nexport class InteractionComponent implements OnInit,OnDestroy {\r\n\r\n  rec : any\r\n  audioChunks: any[]\r\n  stop: boolean = true\r\n  play: boolean = false\r\n  estadoConexionCliente : string = \"\"\r\n  session : any\r\n  loading: boolean = false\r\n  historial: any[] = []\r\n  count_saliendo : number = 0;\r\n  count_saludo   : number = 0;\r\n  rate : boolean = false\r\n  h: any \r\n  token : any = localStorage.getItem('token')\r\n  escuchandoMicrofono: boolean = false\r\n  recognoze : any\r\n  escuchando : boolean = false\r\n  \r\n\r\n  constructor(private asvc : AnimationsService, private toastr: ToastrService, private _ele: ElementRef, private isvc: InteractionService) { \r\n\r\n    (<any>window).SpeechRecognition = (<any>window).webkitSpeechRecognition || (<any>window).SpeechRecognition;\r\n\r\n    this.recognoze = new (<any>window).SpeechRecognition();\r\n\r\n    this.recognoze.continuous = true; \r\n    this.recognoze.lang = 'es-ES'; // idioma\r\n    this.recognoze.interimResults = true; // nos da resultados aunque no sean finales\r\n  }\r\n\r\n  ngOnInit() {\r\n\r\n    this.session = JSON.parse(localStorage.getItem('session'))\r\n    this.init()\r\n\r\n    window.speechSynthesis.onvoiceschanged = () => {\r\n      var  voices = window.speechSynthesis.getVoices();\r\n        for ( var i=0; i<voices.length; i++ ){\r\n            if ( voices[i]['lang'] == 'es-CL'  ){\r\n                this.h.voice = voices[i];\r\n            }\r\n        }\r\n    };\r\n  }\r\n\r\n\r\n  init(){\r\n    this.isvc.messages.subscribe(res => {\r\n      if(res.type === \"clientEnterprise\"){\r\n        this.loading = true\r\n        setTimeout(() => {\r\n          this.renderResponseClient(res.data)\r\n          this.isvc.sendMsg({message: \"historial\"})\r\n        },2000)\r\n      }  \r\n\r\n      if(res.type === \"historial\"){\r\n        this.historial = res.data.data\r\n        setTimeout(() => {\r\n          var objDiv = this._ele.nativeElement.querySelector(\".div_chat\");\r\n          objDiv.scrollTop = objDiv.scrollHeight;\r\n        },500)\r\n      }\r\n\r\n      if(res.type === \"saludo\"){\r\n        this.count_saliendo = 0;\r\n        if(this.count_saludo === 0){\r\n          this.count_saludo++\r\n          this.toastr.success('Ya esta en sesi贸n con un usuario cliente','Aviso!')\r\n        }\r\n      }\r\n\r\n      if(res.type === \"exit\"){\r\n        this.count_saliendo++\r\n        if(this.count_saliendo === 1){\r\n          this.count_saludo = 0\r\n          this.toastr.warning('El cliente se ha desconectado de la sesi贸n','Informaci贸n')\r\n        }\r\n      }\r\n    })\r\n\r\n    this.isvc.sendMsg({type:1, profile: this.session.profile, correo: this.session.correo, message: 'typeconnection'})\r\n\r\n    this.isvc.rateGet(this.token).subscribe(res => {\r\n      this.rate = res.rate\r\n    },err => {\r\n      this.toastr.error('Ha ocurrido un error','Error1')\r\n    })\r\n  }\r\n\r\n  initSpeakers(){ \r\n\r\n    var btn = this._ele.nativeElement.querySelector('button.recog')\r\n\r\n    // Funcion empezar / parar\r\n    if( this.escuchando == false ){\r\n        this.recognoze.start();\r\n        this.escuchando = true;\r\n        btn.innerHTML = 'Parar la escucha';\r\n        this.escuchandoMicrofono = true\r\n    }else{\r\n        this.escuchandoMicrofono = false\r\n        this.recognoze.stop()\r\n        this.escuchando = false;\r\n        btn.innerHTML = 'Reconocer Voz&nbsp;<i class=\"fa fa-comment\"></i>';\r\n    }\r\n    // Eventos del Recognizer\r\n    this.recognoze.onresult = (event) => {\r\n      console.log(event,'aqui el evento que frao')\r\n      for( var i=event.resultIndex; i < event.results.length; i++ ){\r\n          if( event.results[i].isFinal ){\r\n              // Si considera que el usuario ya no va a hablar mas\r\n              // o que la frase ha terminado\r\n              $('#entradaTexto').text(event.results[i][0].transcript)\r\n              this.initSpeakers.bind(this);\r\n          }else{\r\n              // Si considera que el usuario va a seguir hablando\r\n              $('#entradaTexto').text(event.results[i][0].transcript)\r\n          }\r\n      }\r\n    }\r\n  }\r\n\r\n  sendMessage(){\r\n\r\n    let message1 = this._ele.nativeElement.querySelector('#entradaTexto').value\r\n    console.log('entro para enviar el mesaje')\r\n    this.isvc.sendMsg({message: \"enterpriseClient\",msg: message1})\r\n    setTimeout(() => {\r\n        this.isvc.sendMsg({message: \"historial\"})\r\n    },500)\r\n  }\r\n\r\n  renderResponseClient(data){\r\n\r\n    this.h = new SpeechSynthesisUtterance();\r\n    this.h.lang = \"es-CL\";\r\n    this.h.text = data\r\n\r\n    speechSynthesis.speak(this.h);\r\n\r\n    var html = `<button class=\"btn btn-primary speak\">Reproducir Audio&nbsp;<i class=\"fa fa-play\"></i></button>`\r\n    \r\n    var html_img = `<h4>${data}</h4>`\r\n\r\n    $('#tag_audio').empty()\r\n    $('#tag_audio').html(html)\r\n    $('#tag_animacion').html()\r\n    $('#tag_animacion').html(html_img)\r\n\r\n    $('#tag_audio').on('click','.speak',() => {\r\n      this.hablar(data)\r\n    })\r\n\r\n    this.loading = false\r\n\r\n  }\r\n\r\n  hablar(data){\r\n    \r\n    this.h = new SpeechSynthesisUtterance();\r\n    this.h.lang = \"es-CL\";\r\n    this.h.text = data\r\n\r\n    speechSynthesis.speak(this.h);\r\n\r\n  }\r\n\r\n  startRecord(){\r\n\r\n    this.stop = false\r\n    this.play = true\r\n    this.audioChunks = [];\r\n    this.rec.start();\r\n  }\r\n\r\n  stopRecord(){\r\n\r\n    this.stop = true\r\n    this.play = false\r\n    this.rec.stop();\r\n\r\n  }\r\n\r\n\r\n  \r\n  ngOnDestroy(){\r\n    this.isvc.sendMsg({message: \"saliendo\"})\r\n    if(!this.rate){\r\n      localStorage.setItem('rate',JSON.stringify({value: 1}))\r\n    }\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { RouterModule } from '@angular/router'\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms'\r\nimport { InteractionComponent } from './interaction.component';\r\n\r\nimport { InteractionRoutes } from './interaction.routes'\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    RouterModule.forChild(InteractionRoutes),\r\n    FormsModule,\r\n    ReactiveFormsModule\r\n  ],\r\n  declarations: [InteractionComponent]\r\n})\r\nexport class InteractionModule { }\r\n","import { Routes } from '@angular/router'\r\n\r\nimport { InteractionComponent } from './interaction.component'\r\n\r\nexport const InteractionRoutes : Routes = [\r\n  {\r\n    path : '',\r\n    component : InteractionComponent\r\n  }\r\n]"],"sourceRoot":""}